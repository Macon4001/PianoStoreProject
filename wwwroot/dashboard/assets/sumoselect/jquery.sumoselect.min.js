/*!
 * jquery.sumoselect - v3.0.3
 * http://hemantnegi.github.io/jquery.sumoselect
 * 2016-12-12
 *
 * Copyright 2015 Hemant Negi
 * Email : hemant.frnz@gmail.com
 * Compressor http://refresh-sf.com/
 */
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports!="undefined"?module.exports=n(require("jquery")):n(jQuery)})(function(n){"namespace sumo";n.fn.SumoSelect=function(t){var i=n.extend({placeholder:"Select Here",csvDispCount:3,captionFormat:"{0} Selected",captionFormatAllSelected:"{0} all selected!",floatWidth:400,forceCustomRendering:!1,nativeOnDevice:["Android","BlackBerry","iPhone","iPad","iPod","Opera Mini","IEMobile","Silk"],outputAsCSV:!1,csvSepChar:",",okCancelInMulti:!1,isClickAwayOk:!1,triggerChangeCombined:!0,selectAll:!1,search:!1,searchText:"Search...",searchFn:function(n,t){return n.toLowerCase().indexOf(t.toLowerCase())<0},noMatch:'No matches for "{0}"',prefix:"",locale:["OK","Cancel","Select All"],up:!1,showTitle:!0},t),r=this.each(function(){var r=this;!this.sumo&&n(this).is("select")&&(this.sumo={E:n(r),is_multi:n(r).attr("multiple"),select:"",caption:"",placeholder:"",optDiv:"",CaptionCont:"",ul:"",is_floating:!1,is_opened:!1,mob:!1,Pstate:[],lastUnselected:null,createElems:function(){var t=this;if(t.E.wrap('<div class="SumoSelect" tabindex="0" role="button" aria-expanded="false">'),t.select=t.E.parent(),t.caption=n("<span>"),t.CaptionCont=n('<p class="CaptionCont SelectBox" ><label><i><\/i><\/label><\/p>').attr("style",t.E.attr("style")).prepend(t.caption),t.select.append(t.CaptionCont),t.is_multi||(i.okCancelInMulti=!1),t.E.attr("disabled")&&t.select.addClass("disabled").removeAttr("tabindex"),i.outputAsCSV&&t.is_multi&&t.E.attr("name")&&(t.select.append(n('<input class="HEMANT123" type="hidden" />').attr("name",t.E.attr("name")).val(t.getSelStr())),t.E.removeAttr("name")),t.isMobile()&&!i.forceCustomRendering){t.setNativeMobile();return}t.E.attr("name")&&t.select.addClass("sumo_"+t.E.attr("name").replace(/\[\]/,""));t.E.addClass("SumoUnder").attr("tabindex","-1");t.optDiv=n('<div class="optWrapper '+(i.up?"up":"")+'">');t.floatingList();t.ul=n('<ul class="options">');t.optDiv.append(t.ul);i.selectAll&&t.is_multi&&t.SelAll();i.search&&t.Search();t.ul.append(t.prepItems(t.E.children()));t.is_multi&&t.multiSelelect();t.select.append(t.optDiv);t.basicEvents();t.selAllState()},prepItems:function(t,i){var r=[],u=this;return n(t).each(function(t,f){f=n(f);r.push(f.is("optgroup")?n('<li class="group '+(f[0].disabled?"disabled":"")+'"><label>'+f.attr("label")+"<\/label><ul><\/ul><\/li>").find("ul").append(u.prepItems(f.children(),f[0].disabled)).end():u.createLi(f,i))}),r},createLi:function(t,i){var u=this,r;t.attr("value")||t.attr("value",t.val());r=n('<li class="opt"><label>'+t.text()+"<\/label><\/li>");r.data("opt",t);t.data("li",r);u.is_multi&&r.prepend("<span><i><\/i><\/span>");(t[0].disabled||i)&&(r=r.addClass("disabled"));u.onOptClick(r);return t[0].selected&&r.addClass("selected"),t.attr("class")&&r.addClass(t.attr("class")),t.attr("title")&&r.attr("title",t.attr("title")),r},getSelStr:function(){var t=[];return this.E.find("option:selected").each(function(){t.push(n(this).val())}),t.join(i.csvSepChar)},multiSelelect:function(){var t=this,r;t.optDiv.addClass("multiple");t.okbtn=n('<p tabindex="0" class="btnOk">'+i.locale[0]+"<\/p>").click(function(){t._okbtn();t.hideOpts()});t.cancelBtn=n('<p tabindex="0" class="btnCancel">'+i.locale[1]+"<\/p>").click(function(){t._cnbtn();t.hideOpts()});r=t.okbtn.add(t.cancelBtn);t.optDiv.append(n('<div class="MultiControls">').append(r));r.on("keydown.sumo",function(i){var r=n(this);switch(i.which){case 32:case 13:r.trigger("click");break;case 9:if(r.hasClass("btnOk"))return;case 27:t._cnbtn();t.hideOpts();return}i.stopPropagation();i.preventDefault()})},_okbtn:function(){var n=this,t=0;i.triggerChangeCombined&&(n.E.find("option:selected").length!==n.Pstate.length?t=1:n.E.find("option").each(function(i,r){r.selected&&n.Pstate.indexOf(i)<0&&(t=1)}),t&&(n.callChange(),n.setText()))},_cnbtn:function(){var n=this,t;for(n.E.find("option:selected").each(function(){this.selected=!1}),n.optDiv.find("li.selected").removeClass("selected"),t=0;t<n.Pstate.length;t++)n.E.find("option")[n.Pstate[t]].selected=!0,n.ul.find("li.opt").eq(n.Pstate[t]).addClass("selected");n.selAllState()},SelAll:function(){var t=this;if(t.is_multi){t.selAll=n('<p class="select-all"><span><i><\/i><\/span><label>'+i.locale[2]+"<\/label><\/p>");t.optDiv.addClass("selall");t.selAll.on("click",function(){t.selAll.toggleClass("selected");t.toggSelAll(t.selAll.hasClass("selected"),1)});t.optDiv.prepend(t.selAll)}},Search:function(){var r=this,f=r.CaptionCont.addClass("search"),u=n('<p class="no-match">'),e=t.searchFn&&typeof t.searchFn=="function"?t.searchFn:i.searchFn;r.ftxt=n('<input type="text" class="search-txt" value="" placeholder="'+i.searchText+'">').on("click",function(n){n.stopPropagation()});f.append(r.ftxt);r.optDiv.children("ul").after(u);r.ftxt.on("keyup.sumo",function(){var t=r.optDiv.find("ul.options li.opt").each(function(t,i){var i=n(i),u=i.data("opt")[0];u.hidden=e(i.text(),r.ftxt.val());i.toggleClass("hidden",u.hidden)}).not(".hidden");u.html(i.noMatch.replace(/\{0\}/g,"<em><\/em>")).toggle(!t.length);u.find("em").text(r.ftxt.val());r.selAllState()})},selAllState:function(){var t=this,r,u;i.selectAll&&t.is_multi&&(r=0,u=0,t.optDiv.find("li.opt").not(".hidden").each(function(t,i){n(i).hasClass("selected")&&r++;n(i).hasClass("disabled")||u++}),r===u?t.selAll.removeClass("partial").addClass("selected"):r===0?t.selAll.removeClass("selected partial"):t.selAll.addClass("partial"))},showOpts:function(){var t=this,r;if(!t.E.attr("disabled")){t.E.trigger("sumo:opening",t);t.is_opened=!0;t.select.addClass("open").attr("aria-expanded","true");t.E.trigger("sumo:opened",t);t.ftxt?t.ftxt.focus():t.select.focus();n(document).on("click.sumo",function(n){if(!t.select.is(n.target)&&t.select.has(n.target).length===0){if(!t.is_opened)return;t.hideOpts();i.okCancelInMulti&&(i.isClickAwayOk?t._okbtn():t._cnbtn())}});t.is_floating&&(r=t.optDiv.children("ul").outerHeight()+2,t.is_multi&&(r=r+parseInt(t.optDiv.css("padding-bottom"))),t.optDiv.css("height",r),n("body").addClass("sumoStopScroll"));t.setPstate()}},setPstate:function(){var n=this;n.is_multi&&(n.is_floating||i.okCancelInMulti)&&(n.Pstate=[],n.E.find("option").each(function(t,i){i.selected&&n.Pstate.push(t)}))},callChange:function(){this.E.trigger("change").trigger("click")},hideOpts:function(){var t=this;t.is_opened&&(t.E.trigger("sumo:closing",t),t.is_opened=!1,t.select.removeClass("open").attr("aria-expanded","true").find("ul li.sel").removeClass("sel"),t.E.trigger("sumo:closed",t),n(document).off("click.sumo"),t.select.focus(),n("body").removeClass("sumoStopScroll"),i.search&&(t.ftxt.val(""),t.ftxt.trigger("keyup.sumo")))},setOnOpen:function(){var t=this,n=t.optDiv.find("li.opt:not(.hidden)").eq(i.search?0:t.E[0].selectedIndex);(!n.hasClass("disabled")||(n=n.next(":not(disabled)"),n.length))&&(t.optDiv.find("li.sel").removeClass("sel"),n.addClass("sel"),t.showOpts())},nav:function(n){var i=this,o,f=i.ul.find("li.opt:not(.disabled, .hidden)"),t=i.ul.find("li.opt.sel:not(.hidden)"),r=f.index(t);if(i.is_opened&&t.length){if(n&&r>0)o=f.eq(r-1);else if(!n&&r<f.length-1&&r>-1)o=f.eq(r+1);else return;t.removeClass("sel");t=o.addClass("sel");var u=i.ul,s=u.scrollTop(),e=t.position().top+s;e>=s+u.height()-t.outerHeight()&&u.scrollTop(e-u.height()+t.outerHeight());e<s&&u.scrollTop(e)}else i.setOnOpen()},basicEvents:function(){var t=this;t.CaptionCont.click(function(n){t.E.trigger("click");t.is_opened?t.hideOpts():t.showOpts();n.stopPropagation()});t.select.on("keydown.sumo",function(n){switch(n.which){case 38:t.nav(!0);break;case 40:t.nav(!1);break;case 65:if(t.is_multi&&n.ctrlKey){t.toggSelAll(!n.shiftKey,1);break}else return;case 32:if(i.search&&t.ftxt.is(n.target))return;case 13:t.is_opened?t.optDiv.find("ul li.sel").trigger("click"):t.setOnOpen();break;case 9:i.okCancelInMulti||t.hideOpts();return;case 27:i.okCancelInMulti&&t._cnbtn();t.hideOpts();return;default:return}n.preventDefault()});n(window).on("resize.sumo",function(){t.floatingList()})},onOptClick:function(t){var r=this;t.click(function(){var t=n(this),u;t.hasClass("disabled")||(u="",r.is_multi?(t.toggleClass("selected"),t.data("opt")[0].selected=t.hasClass("selected"),t.data("opt")[0].selected===!1&&(r.lastUnselected=t.data("opt")[0].textContent),r.selAllState()):(t.parent().find("li.selected").removeClass("selected"),t.toggleClass("selected"),t.data("opt")[0].selected=!0),r.is_multi&&i.triggerChangeCombined&&(r.is_floating||i.okCancelInMulti)||(r.setText(),r.callChange()),r.is_multi||r.hideOpts())})},setText:function(){var t=this,r,u,f,e;if(t.placeholder="",t.is_multi){for(r=t.E.find(":selected").not(":disabled"),u=0;u<r.length;u++)if(u+1>=i.csvDispCount&&i.csvDispCount){t.placeholder=r.length===t.E.find("option").length&&i.captionFormatAllSelected?i.captionFormatAllSelected.replace(/\{0\}/g,r.length)+",":i.captionFormat.replace(/\{0\}/g,r.length)+",";break}else t.placeholder+=n(r[u]).text()+", ";t.placeholder=t.placeholder.replace(/,([^,]*)$/,"$1")}else t.placeholder=t.E.find(":selected").not(":disabled").text();return f=!1,t.placeholder||(f=!0,t.placeholder=t.E.attr("placeholder"),t.placeholder||(t.placeholder=t.E.find("option:disabled:selected").text())),t.placeholder=t.placeholder?i.prefix+" "+t.placeholder:i.placeholder,t.caption.html(t.placeholder),i.showTitle&&t.CaptionCont.attr("title",t.placeholder),e=t.select.find("input.HEMANT123"),e.length&&e.val(t.getSelStr()),f?t.caption.addClass("placeholder"):t.caption.removeClass("placeholder"),t.placeholder},isMobile:function(){for(var t=navigator.userAgent||navigator.vendor||window.opera,n=0;n<i.nativeOnDevice.length;n++)if(t.toString().toLowerCase().indexOf(i.nativeOnDevice[n].toLowerCase())>0)return i.nativeOnDevice[n];return!1},setNativeMobile:function(){var n=this;n.E.addClass("SelectClass");n.mob=!0;n.E.change(function(){n.setText()})},floatingList:function(){var t=this;t.is_floating=n(window).width()<=i.floatWidth;t.optDiv.toggleClass("isFloating",t.is_floating);t.is_floating||t.optDiv.css("height","");t.optDiv.toggleClass("okCancelInMulti",i.okCancelInMulti&&!t.is_floating)},vRange:function(n){var t=this,i=t.E.find("option");if(i.length<=n||n<0)throw"index out of bounds";return t},toggSel:function(t,i){var r=this,u;(typeof i=="number"?(r.vRange(i),u=r.E.find("option")[i]):u=r.E.find('option[value="'+i+'"]')[0]||0,u&&!u.disabled)&&u.selected!==t&&(u.selected=t,r.mob||n(u).data("li").toggleClass("selected",t),r.callChange(),r.setPstate(),r.setText(),r.selAllState())},toggDis:function(n,t){var i=this.vRange(t);i.E.find("option")[t].disabled=n;n&&(i.E.find("option")[t].selected=!1);i.mob||i.optDiv.find("ul.options li").eq(t).toggleClass("disabled",n).removeClass("selected");i.setText()},toggSumo:function(n){var t=this;return t.enabled=n,t.select.toggleClass("disabled",n),n?(t.E.attr("disabled","disabled"),t.select.removeAttr("tabindex")):(t.E.removeAttr("disabled"),t.select.attr("tabindex","0")),t},toggSelAll:function(t,i){var r=this;r.E.find("option:not(:disabled,:hidden)").each(function(i,r){var u=r.selected,r=n(r).data("li");r.hasClass("hidden")||(t?u||r.trigger("click"):u&&r.trigger("click"))});i||(!r.mob&&r.selAll&&r.selAll.removeClass("partial").toggleClass("selected",!!t),r.callChange(),r.setText(),r.setPstate())},reload:function(){var t=this.unload();return n(t).SumoSelect(i)},unload:function(){var n=this;return n.select.before(n.E),n.E.show(),i.outputAsCSV&&n.is_multi&&n.select.find("input.HEMANT123").length&&n.E.attr("name",n.select.find("input.HEMANT123").attr("name")),n.select.remove(),delete r.sumo,r},add:function(t,i,u){var f,o,e;if(typeof t=="undefined")throw"No value to add";if(f=this,o=f.E.find("option"),typeof i=="number"&&(u=i,i=t),typeof i=="undefined"&&(i=t),e=n("<option><\/option>").val(t).html(i),o.length<u)throw"index out of bounds";return typeof u=="undefined"||o.length===u?(f.E.append(e),f.mob||f.ul.append(f.createLi(e))):(o.eq(u).before(e),f.mob||f.ul.find("li.opt").eq(u).before(f.createLi(e))),r},remove:function(n){var t=this.vRange(n);t.E.find("option").eq(n).remove();t.mob||t.optDiv.find("ul.options li").eq(n).remove();t.setText()},removeAll:function(){for(var t=this,i=t.E.find("option"),n=i.length-1;n>=0;n--)i[n].selected!==!0&&t.remove(n)},find:function(n){var r=this,t=r.E.find("option");for(var i in t)if(t[i].value===n)return parseInt(i);return-1},selectItem:function(n){this.toggSel(!0,n)},unSelectItem:function(n){this.toggSel(!1,n)},selectAll:function(){this.toggSelAll(!0)},unSelectAll:function(){this.toggSelAll(!1)},disableItem:function(n){this.toggDis(!0,n)},enableItem:function(n){this.toggDis(!1,n)},enabled:!0,enable:function(){return this.toggSumo(!1)},disable:function(){return this.toggSumo(!0)},init:function(){var n=this;return n.createElems(),n.setText(),n}},r.sumo.init())});return r.length===1?r[0]:r}});