function isElementInViewport(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function setCookie(e,t,n){var i=e+"="+t+";path=/";if(n){var a=(new Date).getTime();i+=";max-age="+n+";expires="+new Date(a+1e3*n).toGMTString()}document.cookie=i}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var a=n[i];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return decodeURIComponent(a.substring(t.length,a.length).replace(/\+/g,"%20"))}return""}function getParameterByName(e,t){t||(t=window.location.href),t=t.toLowerCase(),e=e.replace(/[\[\]]/g,"\\$&").toLowerCase();var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function getQueryStringsAsObject(){var e={};return location.search.slice(1).split("&").forEach(function(t){t=t.split("="),e[t[0]]=decodeURIComponent(t[1]||"")}),JSON.parse(JSON.stringify(e))}function getCookieAsObject(){return document.cookie.split(";").map(function(e){return e.trim().split("=").map(decodeURIComponent)}).reduce(function(e,t){try{e[t[0]]=JSON.parse(t[1])}catch(n){e[t[0]]=t[1]}return e},{})}function getMetaContent(e,t){var n=$('meta[name = "'+e+'"]').attr("content");return n||t}function fireAnalyticsEvent(e,t){"function"==typeof gtag&&gtag("event",t,{event_category:e})}!function(e){var t;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var n=window.Cookies,i=window.Cookies=e();i.noConflict=function(){return window.Cookies=n,i}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function a(){}function o(t,n,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},a.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var r=JSON.stringify(n);/^[\{\[]/.test(r)&&(n=r)}catch(e){}n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=t+"="+n+s}}function r(e,n){if("undefined"!=typeof document){for(var a={},o=document.cookie?document.cookie.split("; "):[],r=0;r<o.length;r++){var s=o[r].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(i.read||i)(c,l)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(a[l]=c,e===l)break}catch(e){}}return e?a[e]:a}}return a.set=o,a.get=function(e){return r(e,!1)},a.getJSON=function(e){return r(e,!0)},a.remove=function(t,n){o(t,"",e(n,{expires:-1}))},a.defaults={},a.withConverter=n,a}(function(){})}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){return this.substring(!t||t<0?0:+t,t+e.length)===e}}),String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return void 0===t&&(t=0),-1!==this.indexOf(e,t)});var setParentRole=function(){for(var e=document.querySelectorAll("[role=menuitem"),t=0;t<e.length;t++){var n=e[t];"menu"!==n.parentElement.attributes.role.value&&(n.parentElement.attributes.role.value="menu")}},setAriaChildId=function(){for(var e=document.querySelectorAll("[aria-controls*='navigation'"),t=0;t<e.length;t++){var n=e[t],i=n.attributes["aria-controls"].value;n.firstChild.id=i}},removeDescendantAttribute=function(e,t){for(var n=document.querySelectorAll(e),i=0;i<n.length;i++){n[i].removeAttribute(t)}},addRel=function(e,t){for(var n=document.querySelectorAll(e),i=0;i<n.length;i++)n[i].rel=t};setTimeout(function(){setParentRole(),setAriaChildId(),removeDescendantAttribute("[role=button] [role=slider]","role"),removeDescendantAttribute("[role=button] [tabindex]","tabindex"),addRel("a[href$='.pdf']","NOINDEX,NOFOLLOW,NOARCHIVE,NOODP,NOYDIR,NOSNIPPET"),addRel("a[href*='/dam/']","NOINDEX,NOFOLLOW,NOARCHIVE,NOODP,NOYDIR,NOSNIPPET")},500),$(document).ready(function(){function e(){$(".preowned-center")?$(window).scrollTop()>=1?$("header.primary").addClass("sticky"):$("header.primary").removeClass("sticky"):$(window).scrollTop()>=50?$("header.primary").addClass("sticky"):$("header.primary").removeClass("sticky")}$("body, html").resize(function(){$(window).width()>=1e3&&$("header").removeClass("active"),$(".artist-matrix").each(function(){$(".artist-matrix").artistFinder({status:"resize"})})}),$(window).scroll(function(){isBostonEssexSite||e(),$("#scroll-suggest").off("click").remove()});try{e()}catch(e){}var t;function n(e){e.on("afterChange",function(e,t,n){try{var i="Slide "+n+" @ "+window.location.pathname;gtag("event","changed",{event_label:i,event_category:"carousel"})}catch(e){}})}function i(e){var t=$(e+" .secondary-navigation");t.find("a").on("click",function(e){var t=$(e.target).attr("href").slice(1),n=$(e.target).parent().parent().parent().find(".steinway-carousel"),i=n.find('.item[data-hash = "'+t+'"]').data("slickIndex");i>=0&&n.slick("slickGoTo",i)}),n($(e+" .steinway-carousel").slick({dots:!1,adaptiveHeight:!0,arrows:!1,infinite:!1}).on("beforeChange",function(e,n,i,a){var o=t.find("li");o.removeClass("current"),$(o.get(a)).addClass("current")})),$(e+" .secondary-navigation li:first").addClass("current")}if($(".ss-menu-button").on("click touch",function(){$("header").toggleClass("active")}),(t=$("ul.primary>li>ul.secondary").find(".current-page")).length>0&&t.parent().parent().parent().children("a").first().addClass("current-page"),function(e){function t(){var e=$(window).width(),t=e>=720&&i.hasClass("full-takeover"),n=e<720&&i.hasClass("mobile-full-takeover");if(t||n){var a=$("header.primary").height(),o=$(window).height()-a;i.height(o),i.find(".carousel-element").height(o)}else i.css("height",""),i.find(".carousel-element").css("height","")}var i=$(e);(i.hasClass("full-takeover")||i.hasClass("mobile-full-takeover"))&&(t(),$(window).on("resize",t));var a=$(e+" .steinway-carousel");a.find(".carousel-video").each(function(){var e=$(this),t=e.find("video").prop("id"),n=videojs(t),i=e.find(".replay-controls"),o=e.parent().find(".copy-container"),r=null;n.on("play",function(){r=setInterval(function(){if(n.readyState()>0){var e=parseInt(n.currentTime()/60,10),t=Math.floor(n.currentTime()%60),a=e+":"+(o=t,r=2,s=s||"0",(o+="").length>=r?o:new Array(r-o.length+1).join(s)+o);i.find(".video-time").text(a)}var o,r,s},250),n.muted()||o.addClass("video-interact")}).on("pause",function(){null!==r&&clearInterval(r),o.removeClass("video-interact")}).on("volumechange",function(e){n.muted()?o.removeClass("video-interact"):o.addClass("video-interact"),i.addClass("disabled").fadeOut(),a.slick("slickPause")}).on("useractive",function(t){n.muted()&&e.find(".move-visible").not(".disabled").fadeIn()}).on("userinactive",function(t){var n=e.find(".move-visible");n.is(":visible")&&n.fadeOut()}).on("fullscreenchange",function(e){n.muted()&&n.isFullscreen()&&n.muted(!1)}),e.find(".replay-controls").on("click",function(e){n.currentTime(0),n.muted(!1),n.volume(1),n.play(),a.slick("slickPause"),$(e.currentTarget).fadeOut(function(){$(this).remove()})}),e.on("slideVideoPlay",function(e){n.play()}).on("slideVideoPause",function(e){n.pause()})});var o={dots:!0,adaptiveHeight:!0,infinite:!0},r=parseInt(a.data("autoAdvance"));function s(e,t){var n=$(e.$slides[t]).find(".carousel-video");n.find(".video-js").hasClass("autoplay")&&n.trigger("slideVideoPlay")}r>0&&(o.autoplay=!0,o.autoplaySpeed=r,$(window).scroll(function(){isElementInViewport(a)?a.slick("slickPlay"):a.slick("slickPause")})),a.on("init",function(e,t){s(t,0)}),a.slick(o).on("afterChange",function(e,t,n){s(t,n)}).on("beforeChange",function(e,t,n,i){$(t.$slides[n]).find(".carousel-video").trigger("slideVideoPause")}),o.autoplay||n(a)}("section.featured-area"),$("html").hasClass("magnolia-edit")||i("section.tab-details"),i("section.map-filter"),function(e){var t=document.location.hash.slice(1),n=$(e);if(t){var i=n.find('.item[data-hash = "'+t+'"]').data("slickIndex");i>=0&&n.slick("slickGoTo",i,!0)}}("section.map-filter .steinway-carousel"),$(".master-image").length>0){var a=$(".master-image").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!1,asNavFor:".nav-image",adaptiveHeight:!0,mobileFirst:!0,initialSlide:0,useCSS:!0,dots:!0,responsive:[{breakpoint:480,settings:{fade:!1}},{breakpoint:600,settings:{fade:!0}}]});$(".nav-image").slick({slidesToShow:3,slidesToScroll:1,asNavFor:".master-image",dots:!1,arrows:!0,focusOnSelect:!0,adaptiveHeight:!1,useCSS:!0,centerMode:!0,prevArrow:'<span class="carousel-arrow">&#8249;</span>',nextArrow:'<span class="carousel-arrow">&#8250;</span>',responsive:[{breakpoint:1024,settings:{slidesToShow:3}},{breakpoint:600,settings:{slidesToShow:2}},{breakpoint:480,settings:{slidesToShow:1}}]});var o=function(){$(".master-image")[0].slick.refresh()};Pace.on("done",function(){o()});var r=!1;document.addEventListener("fullscreenchange",function(){r&&setTimeout(o,0),r=!r},!1),document.addEventListener("mozfullscreenchange",function(){r&&setTimeout(o,0),r=!r},!1),document.addEventListener("webkitfullscreenchange",function(){r&&setTimeout(o,0),r=!r},!1);a.on("beforeChange",function(e,t,n,i){$("video").each(function(){$(this).get(0).pause()})}),nextSlidePianoDetail=function(e){a.slick("slickGoTo",e)},$("a[data-slide]").click(function(e){e.preventDefault();var t=$(this).data("slide");$(".nav-image").slick("slickGoTo",t-1)})}$(".location-container").each(function(){var e=$(this);google.maps.event.addDomListener(window,"load",function(){var t=new google.maps.Geocoder,n=$(e).find(".address"),i=$(e).find(".map-display-override-url"),a=-34.397,o=150.644;if(i.length>0){var r=(i=i[0].value).split("!3d")[1];a=Number(r.split("!4d")[0]),o=Number(r.split("!4d")[1].split("?")[0])}var s=$(e).find(".google-map");if(s.length>0){var c=new google.maps.Map(s[0],{zoom:15,center:{lat:a,lng:o},scrollwheel:!1,gestureHandling:"none"});if(0===i.length&&n&&n.val())!function(e,t,n){t.geocode({address:e},function(e,t){if(t===google.maps.GeocoderStatus.OK){n.setCenter(e[0].geometry.location);new google.maps.Marker({map:n,position:e[0].geometry.location,scrollwheel:!1})}else alert("Geocode was not successful for the following reason: "+t)})}(n.val(),t,c);else new google.maps.Marker({map:c,position:{lat:a,lng:o},scrollwheel:!1})}})}),$("section.steinway-streaming-player .player-container").each(function(){var e=$(this),t={inwindow:1};e.data("albumId")?t.album_id=e.data("albumId"):e.data("playlistId")&&(t.playlist_id=e.data("playlistId"));var n="http://steinwaystreaming.com/steinway/Streaming",i=e.find(".playlist"),a=e.find("audio").prop("id"),o=videojs(a,{controlBar:{fullscreenToggle:!1}}),r=0,s=Handlebars.compile($("#steinway-playlist-entry-template").html()),c=0,l=[];function u(e){if(l[e]){r=e,o.src(l[e].mp3),o.poster(l[e].album.cover),o.play();var t=i.find("li");t.removeClass("active"),$(t[e]).addClass("active")}}o.on("ended",function(){++r<l.length&&u(r)}),o.on("error",function(){c++;var e=o.error();e&&4===e.code&&c<=5&&$.getJSON(n,t,function(e){Array.isArray(e.tracks)&&(l=e.tracks,u(r))})}),$.getJSON(n,t,function(e){Array.isArray(e.tracks)&&(function(e){$.each(e,function(e,t){t.index=e+1,i.append(s(t))}),i.on("click","li",function(e){u(i.find("li").index(this))}),i.find("li:first").addClass("active")}(l=e.tracks),e.tracks[0]&&(o.src(e.tracks[0].mp3),o.poster(e.tracks[0].album.cover)))})});var s,c={utm_source:"GAsource",utm_medium:"GAmedium",utm_content:"GAcontent",utm_campaign:"GAcampaign",utm_term:"GAterm"};$(function(){$("a[href*=#]:not([href=#])").not("section.accordion a.header").on("click touch",function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);if((e=e.length?e:$("[name="+this.hash.slice(1)+"]")).length)return $("html,body").animate({scrollTop:e.offset().top-80},300),!1}})}),$("#popup_prop65").on("click",function(){$("#popup_prop65_container").trigger("show")}),$("a[aria-label=WeChat]").on("click",function(e){e.preventDefault(),$(".popup.wechat-popup").trigger("show")}),$(".artist-matrix").each(function(){$(".artist-holster").artistFinder({status:"firstBuild"}),$("#artistSearch").artistFinder({search:!0})}),s=!1,$(".popup").each(function(){var e=$(this);e.on("show",function(){s||($(this).addClass("active").find("input,select,textarea").first().focus(),s=!0)}).on("hide",function(){$(this).removeClass("active"),s=!1}),e.find(".popup-body").on("click",function(e){e.stopPropagation()}),e.find(".popup-close").on("click",function(){e.trigger("hide")}),e.on("click",function(){$(this).trigger("hide")})}),$(".open-popup").on("click",function(e){e.preventDefault();var t=$(e.target).data("popup");$(".popup."+t).trigger("show")}),function(e,t,n,i){document.location.host;var a=document.location.pathname,o=getCookie("countryName");Boolean(o)&&a.startsWith(t)&&o!==i&&document.location.replace(n)}(0,"/shop","/errors/outside-us","United States");var l=function(e,t){var n=t+"&"+v(),i=$.Deferred();return $.ajax({url:e,method:"POST",data:n,complete:function(e){201===e.status?i.resolve(JSON.parse(e.responseText)):i.reject()}}),i.promise()},u=function(e,t,n){var i=t+"&"+v()+"&fs[data][transactionid]="+n;console.log(i);var a=$.Deferred();return $.ajax({url:e,method:"POST",data:i,complete:function(e){201===e.status?(console.log(e),$("#payment-checkout-preview__orderNumber").html(JSON.parse(e.responseText).orderNo),a.resolve()):a.reject()}}),a.promise()};$("form.super-validate").on("submitValid.super-validate",function(){var e=$(this).find('input[type="submit"]'),t=e.data("submitting");e.data("default",e.val()),e.val(t)}).on("initialized.super-validate, dependencies-updated.super-validate",function(){!function(e){for(var t=$(e).find(".input-wrapper").filter($.fn.superValidate.disabledDependentsFilter),n=0;n<t.length;n++)n%2==0?$(t[n]).css({clear:"left"}):$(t[n]).css({clear:"none"})}($(this).find("fieldset.columns"))}),$("form.super-validate").on("submitDone.super-validate",function(){var e=$(this),t=e.data("ga-form-type");e.data("track-conversion")&&t.length>0&&fireAnalyticsEvent(t,"submit"),console.log("submitDone: ",t),e.slideUp(function(){e.parent().find(".post-submit-success").first().slideDown()}),e.parent().find(".post-submit-error").first().hide()}),$("form.super-validate").on("submitFail.super-validate",function(){var e=$(this);e.parent().find(".post-submit-success").first().hide(),e.parent().find(".post-submit-error").first().show()}),$("form.super-validate").on("submitAlways.super-validate",function(){var e=$(this).find('input[type="submit"]'),t=e.data("default");e.val(t)}),$("form.super-validate input.other-cn-city").on("activated.super-validate",function(){$(this).siblings(".arrow").hide()}).on("deactivated.super-validate",function(){$(this).siblings(".arrow").show()});var d,f,p,h,g,m;function v(){var e=[],t=getCookieAsObject();for(var n in t)if(n.startsWith("steinway_")){var i=n.split("steinway_")[1];void 0!=c[i]&&(i=c[i]),e.push("fs[data]["+i+"]="+encodeURIComponent(t[n]))}return e.join("&")}$("form.dealer-form").superValidate().on("submitValid.super-validate",function(e,t){t.preventDefault();var n=$(t.target),i=n.attr("action"),a={};try{var o=$("[name='fs[variant]']")[0].value,r=$("[name='fs[category]']")[0].value;if("note-by-note"===o||"the-secrets-of-steinway-webinar"===o||"virtual-factory-tour"===o||"spirio-jfk"===r){a=function(e){var t={};return Object.keys(e).forEach(function(e){t[e]=$("[name='fs[data]["+e+"]']")[0].value}),t}({playsPiano:"no",ownsPianoOrKeyboard:"no",brandOwned:"none",modelOwned:"none",inMarketForPiano:"no",heardOfSpirio:"no"})}}catch(t){}if($("[name='comments_bak']").length>0&&(a.comments=$("[name='comments_bak']")[0].value),$("[name='fs[data][comments]']").length>0&&$("[name='comments_bak']").length<1&&(a.comments=$("[name='fs[data][comments]']")[0].value,$("[name='fs[data][comments]']")[0].name="comments_bak"),$(".custom-checkbox").length>0){for(var s={},c=$(".custom-checkbox"),u=0;u<c.length;u++)s[c[u].name]=c[u].checked;a.checkboxes=s}$("<input>").attr({type:"hidden",name:"fs[data][comments]",value:JSON.stringify(a)}).appendTo(n);var d=n.serialize(),f=l(i,d),p=$(this);f.done(function(){p.trigger("submitDone.super-validate")}).fail(function(){p.trigger("submitFail.super-validate")}).always(function(){p.trigger("submitAlways.super-validate")})}),$("form.payment-form").superValidate().on("submitValid.super-validate",function(e,t){console.log("payment-form"),t.preventDefault();var n=$(t.target),i=n.attr("action"),a=n.serialize(),o=$(this);braintreeInstance.requestPaymentMethod(function(e,t){if(e)$(".preowned-center").find('input[type="submit"]').val("Submit");(function(e,t){$(".preowned-center__checkout--error").hide();var n=e+"&payment_method_nonce="+t;return $.ajax({url:g_performTransactionEndpoint,method:"POST",data:n,success:function(e){return console.log("RESPONSE1: ",e),e},error:function(e,t,n){return console.log("failed at 124"),$(".preowned-center__checkout--error").show(),$(".preowned-center").find('input[type="submit"]').val("Submit"),braintreeInstance.teardown(function(e){e?console.error("Could not tear down Hosted Fields!"):(console.log("Hosted Fields has been torn down!"),instantiateBrainTree())}),!1},complete:function(e){return $(".payment-checkout-preview__confirmation").show(),$(".payment-checkout-preview__hide-on-confirmation").hide(),$(".post-submit-success").hide(),$(".dealer-form-holster > h2").hide(),!0}})})(a,t.nonce).then(function(e){console.log(e),u(i,a,e).done(function(e){console.log("braintree: ",e),fireAnalyticsEvent("cpo-event","reservation-successful"),o.trigger("submitDone.super-validate")}).fail(function(){fireAnalyticsEvent("cpo-event","reservation-failed"),o.trigger("submitFail.super-validate")}).always(function(){o.trigger("submitAlways.super-validate")})})})}),$("form.newsletter-form").superValidate().on("submitValid.super-validate",function(e,t){t.preventDefault();var n=$(t.target),i=n.attr("action"),a=n.serialize(),o=l(i,a),r=$(this);o.done(function(){r.trigger("submitDone.super-validate")}).fail(function(){r.trigger("submitFail.super-validate")}).always(function(){r.trigger("submitAlways.super-validate")})}),$("form.find-location").superValidate().on("submitValid.super-validate",function(e,t){t.preventDefault();var n=$(t.target),i=n.attr("action"),a=n.serialize(),o=n.data("locationsPath"),r=l(i,a),s=$(this);r.done(function(e){s.trigger("submitDone.super-validate");var t="not-found";e.dealer instanceof Array?e.dealer&&e.dealer[0].id&&(t=e.dealer[0].id):e.dealer&&e.dealer.id&&(t=e.dealer.id),setTimeout(function(){window.location=o+"/"+t+"?o=find-location"},4e3)}).fail(function(){s.trigger("submitFail.super-validate")}).always(function(){s.trigger("submitAlways.super-validate")})}),$("textarea.expanding").on("focus",function(){$(this).addClass("expanded")}).on("blur",function(){$.trim($(this).val()).length<=0&&$(this).removeClass("expanded")}),$("button.open-live-chat").on("click",function(e){e.preventDefault();var t=$(this).attr("href");if(t){window.open(t,"newwindow","scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=300,height=500,left=100,top=100")}}),$("a.track-conversion").on("click",function(e){"function"==typeof steinwayTriggerConversion&&steinwayTriggerConversion()}),Pace.options.ajax.trackMethods=["GET","POST"],$("section.accordion a.header").on("click",function(e){e.preventDefault(),$(this).siblings("div.content").slideToggle(),$(this).parent().toggleClass("expanded")}),(d=$("section.secondary-navigation ul.secondary-navigation li.current")).length>0&&!isElementInViewport(d)&&d.parent().scrollLeft(d.offset().left),function(){var e=getQueryStringsAsObject();for(param in e)if(""!=param){var t="steinway_";void 0!=c[param]?t+=c[param]:t+=param,setCookie(t,encodeURIComponent(e[param]))}}(),$("#main a[href^='http://'], #main a[href^='https://']").not("#main a[href*='.steinway']").attr("target","_blank"),function(){var e=[],t=[];if(getMetaContent("ss:supportedContinents")&&(e=getMetaContent("ss:supportedContinents").split(",")),getMetaContent("ss:supportedCountries")&&(t=getMetaContent("ss:supportedCountries").split(",")),0!=e.length||0!=t.length){var n=getCookie("countryCode"),i=getCookie("continentCode");if("false"!=getCookie("geoIpRedirect")&&-1==t.indexOf(n)&&-1==e.indexOf(i)){var a=$("div.foreign-visitor .specific-country-"+n.toLowerCase());if(a.length>0)$(a).removeClass("hide"),$(".popup.foreign-visitor").trigger("show");else{var o=$("div.foreign-visitor .specific-continent-"+i.toLowerCase());o.length>0&&($(o).removeClass("hide"),$(".popup.foreign-visitor").trigger("show"))}}}}(),$(".popup.foreign-visitor").on("hide",function(){setCookie("geoIpRedirect","false",1200),fireAnalyticsEvent("foreign-visitor","decline")}),$(".popup.foreign-visitor a.accept-redirect").on("click",function(){var e=this.getAttribute("href");"function"==typeof gtag&&gtag("event","accept",{event_category:"foreign-visitor",url:e,transport_type:"beacon",event_callback:function(){document.location=e}})}),$("#scroll-suggest").on("click",function(e){$("body").animate({scrollTop:document.documentElement.scrollTop+500},300),$(this).remove()}),$(".share-widget .social-network.facebook").on("click",function(){var e=$('meta[property="og:url"]').prop("content"),t="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e),n=($(window).width()-575)/2,i=($(window).height()-400)/2,a=(this.href,"status=1,width=575,height=400,top="+i+",left="+n);return window.open(t,"twitter",a),!1}),$(".share-widget .social-network.twitter").on("click",function(){var e=$("title").text(),t="http://twitter.com/share?text="+encodeURIComponent(e),n=($(window).width()-575)/2,i=($(window).height()-400)/2,a=(this.href,"status=1,width=575,height=400,top="+i+",left="+n);return window.open(t,"twitter",a),!1});try{f=$("html").attr("lang"),p=$(".brand-header a").attr("href").replace(new RegExp(f+"/$"),""),$(".dealer-banner select.language-selector option[value="+f+"]").prop("selected",!0),$(".dealer-banner select.language-selector").on("change",function(){var e=$(this).val();window.location="en"===e?p:p+e+"/"})}catch(e){}h="input.date-select",g=$("html").attr("lang"),m={},g&&(m.locale=g.split("-")[0].toLowerCase()),$(h).flatpickr(m),function(e){$(e).on("click","div.pagination a",function(e){e.preventDefault();var t=$(this).attr("href"),n=$(this).closest("section");$.ajax({url:t,success:function(e){n.html($(e).children())}})})}("section.list-view"),function(){var e=getCookie("countryCode"),t=getCookie("continentCode");function n(e,t,n){var i=$(e).data(t);return!(!i||-1===(i=i.split(",")).indexOf(n))}$("[data-only-country]").each(function(){n(this,"only-country",e)||$(this).hide()}),$("[data-only-continent]").each(function(){n(this,"only-continent",t)||$(this).hide()}),$("[data-except-country]").each(function(){n(this,"except-country",e)&&$(this).hide()}),$("[data-only-continent]").each(function(){n(this,"except-continent",t)&&$(this).hide()})}(),$("#cpo-learn-more").on("click",function(){fireAnalyticsEvent("cpo-button-click","learn-more")})});var getBrowserLanguage=function(){return navigator.language.split("-")[0]},getPathsAndAvailableLanguages=function(){return[{path:"/spirio-spotlight/quickstart-guide-r/",languages:["de","ja"]},{path:"/spirio-spotlight/quickstart-guide-p/",languages:["de","ja"]},{path:"/spirio-spotlight/quickstart-guide/",languages:["de","ja"]}]},getLocalizedPath=function(){var e=getBrowserLanguage(),t=location.pathname.split("/");return(t=t.splice(0,2,e).concat(t)).join("/")},preferredLanguageIsAvailable=function(e,t){var n=getBrowserLanguage();return e.includes(n)},checkIfPathHasPreferedLanguageAndNavigate=function(){var e=location.pathname;getPathsAndAvailableLanguages().forEach(function(t){e.includes(t.path)&&preferredLanguageIsAvailable(t.languages)&&location.replace(getLocalizedPath())})};function preload(e,t){var n=$(t).find(".steinway-style-showcase__rendering");$(e).each(function(){$("<img />").attr("src",$(this).data("showcaseStyleImageUrl")).appendTo(n).addClass("steinway-style-showcase__rendering--image").addClass("steinway-style-showcase__rendering--image--hidden")})}checkIfPathHasPreferedLanguageAndNavigate();var setRenderingContainerHeight=function(){var e=$(".steinway-style-showcase__rendering--image").height();$(".steinway-style-showcase__rendering").height(e)},removeActiveClass=function(e){var t=$(e).find("ul").children(".steinway-style-showcase__navigation--thumbnails--active"),n=t.find("a").data("showcaseStyleImageUrl");setTimeout(function(){fadeOutActiveImage(e,n)},240),t.removeClass("steinway-style-showcase__navigation--thumbnails--active")},fadeOutActiveImage=function(e,t){e.find('img[src$="'+t+'"]').toggleClass("steinway-style-showcase__rendering--image--hidden",!0)},fadeInNextImage=function(e,t){e.find('img[src$="'+t+'"]').toggleClass("steinway-style-showcase__rendering--image--hidden",!1)},setActiveStyleFromThumbnailTarget=function(e){var t=$(e).closest(".steinway-style-showcase");if(!$(e).parent("li").hasClass("steinway-style-showcase__navigation--thumbnails--active")){removeActiveClass(t),$(e).parent("li").addClass("steinway-style-showcase__navigation--thumbnails--active");var n=$(e).data("showcaseStyleDescription"),i=$(e).data("showcaseStyleImageUrl"),a=$(e).data("showcaseStyleImageTitle");fadeInNextImage(t,i),t.find(".steinway-style-showcase__navigation--description").html(n),t.find(".steinway-style-showcase__navigation--name").html(a)}};$(".steinway-style-showcase__navigation--thumbnails--image").on("click",function(e){e.preventDefault(),setActiveStyleFromThumbnailTarget($(this).closest("a"))});var getSectionThumbnailStyleTypes=function(e){var t={},n=getSectionThumbnails(e);return $(n).each(function(e,n){t[$(n).data("showcaseStyleType")]=n}),Object.keys(t)},getSectionThumbnailStylesByType=function(e){var t={},n=getSectionThumbnails(e);return getSectionThumbnailStyleTypes(e).forEach(function(e){t[e]=$(n).filter(function(){return $(this).data("showcaseStyleType")===e})}),t},getSectionThumbnails=function(e){return $(e).find(".steinway-style-showcase__navigation--thumbnails--image")},setActiveTabType=function(e,t){var n=getSectionThumbnailStylesByType(e);getSectionThumbnailStyleTypes(e).forEach(function(e){e===t?$(n[e]).closest("li").show():$(n[e]).closest("li").hide()}),$(e).find("button").each(function(e,n){$(n).data("showcaseStyleTabButtonType")===t?$(n).addClass("steinway-style-showcase__navigation--tabs--active"):$(n).removeClass("steinway-style-showcase__navigation--tabs--active")}),setActiveStyleFromThumbnailTarget($(n[t]).first())},getSectionTabs=function(e){return $(e).find(".steinway-style-showcase__navigation--tabs")};$(".steinway-style-showcase__navigation--tabs button").on("click",function(e){var t=$(this).closest(".steinway-style-showcase"),n=$(this).data("showcaseStyleTabButtonType");setActiveTabType(t,n)}),$(".steinway-style-showcase").each(function(e,t){var n=t,i=getSectionThumbnails(n),a=getSectionThumbnailStyleTypes(n),o=getSectionTabs(n);preload(i,n),a.length>1?(o.show(),setActiveTabType(n,"grand-piano")):(o.hide(),setActiveStyleFromThumbnailTarget($(i).first()))}),function(e,t){jQuery.fn[t]=function(e){return e?this.bind("resize",(n=e,function(){var e=this,t=arguments;o?clearTimeout(o):a&&n.apply(e,t),o=setTimeout(function(){a||n.apply(e,t),o=null},i||100)})):this.trigger(t);var n,i,a,o}}(jQuery,"smartresize"),$(window).smartresize(function(){setRenderingContainerHeight()}),$(window).load(function(){setRenderingContainerHeight()});